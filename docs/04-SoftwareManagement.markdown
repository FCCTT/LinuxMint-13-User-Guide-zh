## 软件管理

### Linux Mint中的软件包管理

如果您是第一次安装 Linux 操作系统，那么可能会对把软件打成软件“包”的概念的不甚了解。不过您会很快熟悉这种软件包管理方式，并且会赞赏它在安全性、可控性和易用性上带来的优势。

我们努力做到让系统在安装时检测到您电脑上所有或绝大多数的硬件设备并自动安装驱动程序，这样就可以“开箱即用”。另外系统也自带了许多软件使您不必再费力从繁杂的网站上寻找第三方软件来完成许多工作。您可能会发现Linux Mint已经集成了一套完整的Office工具、一个专业水准的图形处理软件、IM和IRC聊天客户端、一个光盘刻录程序和几个媒多播放器以及其它基本组件。不过敬请放心，您没有盗用任何东西，所有这些都是自由软件！Linux Mint的软件管理方式还有一个非常大的优点，就是您无需再为找一些软件而四处寻寻觅觅，即使有时候您确实需要从Linux Mint系统获得更多的功能。

本章节旨在介绍软件管理器怎么工作以及它会给您带来哪些便捷。尽管篇幅有一些长，但是我们希望这能使您理解软件管理背后的哲学思想以及它为什么被称为“上成之作”（这是Linux用户常用来形容某种事物确实不错的一个词汇），如果您时间有限，那么可以跳过下面这一部分，其内容是介绍如何使用软件包系统的。

通过浏览软件供应商的官网下载安装软件会产生诸多的问题： 

- 难以确定甚至根本无法确定这个软件是否已经经过测试并且可以在您的系统上正确运行

- 难以确定甚至根本无法确定这个软件是否会与系统中其它的软件发生冲突

- 难以确定甚至根本无法确定那些素不相知的软件开发者是否会有意、无意的对我们的电脑造成损害，即使您对软件及其开发者已经有了足够的了解，但仍有一点要着重指出的是：您下载的可执行文件有可能会被居心不良的第三方用恶意软件所替代了。

再者从不同开发者的网站上下载安装众多不同的软件会导致您没法系统地管理它们。在您说“这没什么大不了的”之前，请想想您用什么方式来保持不同软件得到更新。如果您厌倦了、不想继续使用某个程序时又该如何卸载？也许软件根本就没有卸载选项，即使有许多情况下也没办法将软件干净、彻底的移除。还有一个现实的问题，一旦您运行了安装程序就等于把电脑的操控权交给了一个陌生人写的程序手上。

最后一点，出于需要，以这种方式发行的软件通常是“静态的”。这意味着您不但要下载软件本身，还要下载软件运行所必需的全部库文件，因为一个第三方软件不会知道您的电脑里已经安装哪些库。唯一能确保程序能在系统中顺利运行的方法就是把软件运行所需的所有库文件都提供给您。这意味要下载更大的文件，同样当一个库文件要升级时，您要针对每一个使用这个文件的软件都进行相应的操作，而不能一次性完成。总而言之，以静态方式发布的软件会导致许多不必要的重复劳动。

Linux Mint和其它的GNU/Linux操作系统采取现在的软件包管理方式已经相有当长的时间了，这是一种可以有效避免以上问题的软件管理方式。上世纪90年代早期开始，我们就已经能自动且安全地进行软件安装了。

正如大家所知，起先，软件是由开发者编写的，这个生产链的最未端是“upstream”。作为一名Linux发行版的用户，您被称为处于最远端的“downstream”（除非您是管理员，这种情况下您的用户才是最远端downstream，而作为管理员您对此是了解的）。当开发者对他们所编写的软件或者软件更新很满意时，就会发布源代码。他们会在文档中描述自己在开发过程中借鉴或使用了哪些库或者程序。长久以来他们一直在这样做，并且已经够规范化了，这种方式很令人敬佩！请注意，他们发布的是真正的程序源代码，也就是说程序中有方便他人参考的注泽，一些少数开发者除外（通常指为Linux提供驱动的硬件开发商，比如nVidia、ATI或者像Adobe这样值得信赖的一些大公司）。这些都意义重大，不过最重要的一点是这意味着他们愿意让每一个可以联接互联网的人查看他们的代码，而当每个人都可以查看您写的代码时您想在程序中隐藏一个间谍软件是极不容易的。

软件包的维护者通常是志愿者或某个Linux发行版的雇员，现在软件将流传递给他们。这些人的职责是完成软件源代码并在发行版上进行测试以确保能正常运行，他们要解决所遇到的问题并最终以适当的格式将程序打包编译好（即机器能识别的代码）。软件包中的软件包括可执行文件、配置文件以及安装软件所需的说明。请注意，它不会提供任何的静态库，因为根本不需要，这些库已经由其他的软件包提供了，因此称之为共享库。您的软件包管理器会检测安装某个特定的软件包是否需要先安装其它的软件包(比如说共享库)，您应该记得，远端的upstream 已经声明了软件包需要的库文件和关联的软件包，这些信息已经被记录在软件包里。在文档说明中详细地列出了需要用到的其他软件包的版本号等信息以保证互用性。软件包完成后就会被上传到特定的文件服务器中，通常称之为软件仓库。

这样您在下载安装软件时只要找到软件包管理器这块宝地就行了。这绝对是一个妙不可言的世界，软件包管理器会检查软件的证书。每个软件包都被签署了GPG密钥，软件包管理器同样会对此进行检查，以确保软件是可信安全的。软件包管理器甚至会检验每个软件包的MD5值来确保在下载过程中没有出现错误，就像我们在检验LiveDVD的iso文件那样。当然这些都是系统自动完成的，您所要做的仅仅是坐在一旁一边品着马丁尼鸡尾酒一边在Xchat上的#linuxmint频道聊天而已 。软件包管理器会下载您选定的软件包，然后严格按照软件包中的指令以正确的顺序安装选定的软件包和依赖软件包（计算机是热衷于按指令运行的）。在这一过程中，人为错误是没有机会出现的，如果软件包能在维护者的电脑上运行，那么它就可以在您的电脑上运上，因为两者种情形下软件管理器进行的是一模一样的工作。

软件检查更新时，您的软件包管理器会自动比较当前软件的版本和源里软件的版本，做一系列必要的工作来使您的系统能够顺利安全地运行。所以，如果 BestSoft 的 2.4 版本被上传到源里，您系统中有的是 2.3 版本，软件包管理器将会比较这些版本差异，然后提示您去安装最新的版本。当然，也会同时更新升级的所依赖的软件包。

听起来很不错吧？实际上它比这更出色。 

“人会出错但计算机不会。”这句话也不永远正确。我们都遇到过这样的事，装错了硬件驱动给系统带来损害，有时会遇到了漏洞，或者您钟情的特性被开发者出于某种原因移除了。这些问题都是软件包管理健壮性和安全性的表现。因为您的软件包管理器一丝不苟地记录了它所做的一切，所以可以干净而彻底地进行软件卸载。它会确保在卸载一个软件包时不会对其它软件包的软件造成破坏，您甚至可以指定它做一些特殊的任务，比如按您的意愿取消一些特定的软件包的升级或者使其退回到旧版本。您跟每一个Linux Mint使用者一样都可以亨受这些功能，因为您是庞大的Linux社区的一部分，整个社区都在使用相同的源来获取软件。假如您遇到了某个问题，这个问题也会出现在一大堆人的电脑上，所以它会很快得到解决的。自最初的开发者将他们的代码公布网上使所有人都可以查看以及在发布的网站上进行讨论的之时，在Linux发行版上发布的软件即建立了使人强烈信任的基础。您应该对自己使用软件有信心，不仅仅因为此前提及的安全协议也因为任何软件的差错都会在网络社区中得到交流。

我们再看一遍这些问题的列表以及解决方案：

- 难以核实软件是否已经在您所用的系统上通过了测试
  - 您应该知道从源里下载的软件已经被软件包的维护者和测试团队在您所用的系统上进行过认真细致的测试了。他们不会放任错误的存在，这不仅基于强烈责任心也是因为他们不这么做的话电子邮箱中的反馈邮件就会纷至沓来。
- 很难知道某个软件是否会与系统中已安装的其它软件发生冲突
  - 与此类似，维护者尽量不会使他们发布的软件包与系统中的其它软件发生冲突。当然他们不会把每个软件都装在系统里进行测试（实际上，每次测试用的都是纯净的系统，这样可以保证系统是处于标准状态），但是如果有社区用户反映出现了状况，他们就会通知发布团队，这样问题就会被修复至少会朝这方面努力。除非您是beta 用户，否则您不太可能会遇到软件冲突这样的问题，因为beta版本来就是用来测试的嘛。
- 很难知道您是否可以给予软件开发者完全的信任，因为您不知道他们软件是否会有意无意地损害您的电脑
  - 软件包维护者几乎不可能将那些损害人们电脑（甚至软件包括他们自己的）的软件打包，只有那些被人们了解和信任的软件才会被加入到源中。
- 即使您对软件及其开发者有一定的了解，但是您仍不能完全确定所下载的可执行文件是否已经被第三方的恶意软件所取代
  - 除了服务器的管理机构（通常是有名望的学校或研究机构和大公司）采取通常的安全措施外，源和软件包也有证书和GPG密钥的防护。如果有错误发生，软件包管理器会进行提示。本文的作者在使用Linux的十几年里从未遇到过这方面的问题。
- 很难移除己安装的软件及其依赖联系
  - 因为软件包管理器详细记录了软件的行为，所以只要保证移除一个软件包不会造成其它软件的错误，对以前发生的步聚进行反置操作是完全可行的。
- 静态软件包庞大而臃肿
  - 因为您使用了软件包管理器，所以只有在没有共享库的替代品的时候才需要下载静态库。如果在安装软件时需新的共享数据库，您的软件包管理器会自动进行下载。一个共享库只需下载一次，它会被所有使用到它的软件所共享。如果您移除了最后一个需要某个共享库的程序，软件包管理器会将共享库一并移除。当然，如果您以后可能会用到这个库，可以决定将其保留也可以让软件包管理器不移除它。
- 我仍然没有被说服
  - 好吧，如果您真的很在意软件包管理器的话就在论坛上发个贴子征求意见或着问一下别人的经历，GNU/Linux这种发行软件包的方式所获得信任是经得住反复考验的。对于任何意见和批评，我们洗耳恭听。

最后说几点。您或许受传言的影响认为Linux是一个半成品，您只是一个beta版的测试者或Linux软件不稳定。某种程度来说没错，与其它被认为已经做到了极致的大型操作系统相比，“Linux”项目永远不会完工。从Linux内核到电脑屏幕上的艺术品都将永远处于某种发展之中，原因在于程序员们正努力使我们的体验跟上软件和硬件发展的步伐。这并不表示您使用的软件质量欠佳，Linux Mint基于的核心系统已经有了二十几年的开发历程，它成熟、稳定并且值得信赖。当您的操作系统中有许多不稳定的软件时，您就不会使用它，因为您不是一个测试者。怎么知道您不是测试者呢？读了这篇文章您就知道了。源里为您提供的软件永远是稳定并通过测试的，除非您自己换成了测试者的源（这样的话，就恭喜您成了测试者了），不过这的确不是明智之举。

接下来，用例子做一下总结吧，当您在Linux Mint里安装Opera、Real Player、Google Earth时，这些软件可不是直接来自于它们的开发者（Opera、Real Player、Google）。当然这些软件是由开发者开发的，但只有被正确地打包和测试之后才会被提供给您使用。换句话说，您不用再去网上寻找软件，您所需要的一切，Linux Mint和Ubuntu团队已经为您测试好了。您只要选择自己想做的事情就行了。

就是这么简单！

Opera、Skype、Acrobat Reader 、Google Earth和Real Player等一些最流行的软件在Linux Mint中并没有被默认安装。

### 软件管理器

Linux Mint中最便捷的软件安装方式是使用软件管理器。它建立在我们此前讨论过的软件包技术的基础上，使用起来更加方便易懂，它使您用安装软件的方式安装而不是软件包（不过记住了，它后台使用的也是软件包管理系统，所以也有同样的优点）。

打开菜单选择“软件管理器”。

在软件管理器中您可以浏览Linux Mint可以安装的软件。您可以按目录查看，可以通过关键字搜索或者通过评分或流行度进行排序。

菜单

如果您知道自己要找的程序是什么则不要运行任何程序。只要在菜单里输上程序的名字就可以安装这个程序。

举个例子，安装“gftp”软件包：

- 按下CTRL+Super_L启动菜单
- 键入“gftp”
- 按“Up”键高亮选中“Intall gftp”键
- 按Enter 

怎么样，软件包管理器是不是很好用？

### 新立得和APT

如果您不仅仅想安装一个应用程序，或者您找的软件不在软件入口（ Software Portal）或软件管理器中。Linux Mint提供了另外两种安装软件的方法，是一个叫“新立得”的图形界面工具和一个叫“APT”的命令行工具。

我们来演示一下如何使用那两种工具安装Opera（Firefox的替代品）：

打开菜单选择“软件包管理器”。

点击“搜索”按钮并输入“opera”。在查看软件包的列表项中选中与Opera Web浏览器相符的那一项。勾选它并选择“标记为安装”，点击“应用”按钮。

现在我们来看一下怎么使用APT命令行工具安装Opera。

打开菜单选择“终端”，输入以下命令：

    apt install opera

注意：使用APT前务必关闭新立得，由于新立得在后台运行APT所以二者不能同时启动。同样地软件管理器也是如此。

APT使用起来非常简单但是没有图形界面，如果您刚开始使用Linux应该更喜欢使用图形界面（这也是它存在的原因），但是随着时间的流逝您会更青睐于快速高效的命令行工具，就像安装Opera最快的方法是输入“apt install opera”，没有比这更简单的了。

软件管理器和新立得/APT之间有一个重要的不同之处，新立得和APT主要用来处理软件包。在我们的例子中Opera非常简单，本身只由一个名为“opera”的软件包组成，但并非所有情况都是如此，而且有时候您并不知道软件包的名字。甚至有些时候您都接触不到软件的软件包。

软件管理器的不同之处在于，在安装程序时不仅像新立得和APT那样从源（软件包数据库）里获得软件包，还会从Internet的其它地方获得。

因此，您选择使用软件管理器可能基于以下两方面的原因：

- 不习惯使用新立得/APT
- 它安装的某些软件您通过别的方式无法安装。

### 删除应用程序

#### 从菜单中删除

在Linux Mint里删除一个软件是很简单的。只需要在菜单里标注应用程序，单击右键选择“卸载”即可。

在菜单中会找到您要删除的软件包和它的依赖关系。

单击删除，应用程序就会被删除了。

#### 使用APT删除

另外一个删除软件的方法就是使用APT命令，我们又在讨论命令行工具了。让我们来看看它是多么简单而令人惊讶吧。

打开主菜单，选择终端，输入下面的命令

    apt remove opera
    
注意：确保你的新立得已经关闭了，因为新立得的后台运行的实际上是APT工具，它们不可以同时运行。

搞定，你只用了一条指令就把Opera从计算机中移除了。

#### Synaptic（新立得）

你也可以使用新立得来删除包，因为Linux下总有很多选择，让我们来看看怎么使用它吧： 

打开主菜单选择“包管理器”

点击搜索按钮，选择“Opera”，然后查看包的列表，找对应于Opera浏览器的选项。勾选它们，右键选择标记为删除，单击“应用”按钮即可。

### 更新你的系统和应用软件

如果安装在您电脑上的包有新版本了，您可以升级最新版。它可能是操作系统一个组件的更新，可能是某个库的优化，也可能是火狐浏览器的一个新版本。基本上，你的系统是由包组成的，任何一部分都可以通过升级包来更新。这就意味着用一个新版本的包替换当前的包。

更新的方法很多，但在此只推荐一种。 

你可以用一个简单的APT命令（apt upgrade)来更新系统的所有包，但我们建议你不要这样做。原因是这个工具在选择更新时不做任何区分，默认您都要更新。

系统的部分包可以安全更新，但是有一些就不行了。例如，更新您的内核（它负责很多事情，比如说硬件的识别）您可能会损坏声卡的支持，网卡的支持甚至一些和系统内核相关的应用程序（比如VMWare 和 Virtualbox）。

#### 使用更新管理器

Linux Mint 有一个叫“更新管理器”的工具。它提供了许多关于更新的信息,在更新之前让您决定怎么安全地更新。它看起来像一个盾牌，坐在您屏幕的右下角。

![update-manager](https://github.com/oppih/LinuxMint-13-User-Guide-zh/raw/master/images/update-manager.png)

如果您将鼠标移动到上边,它会告诉您系统是否有更新,如果有的话,指出有什么可用的更新。

如果你点击锁按钮,更新管理器就打开了,并显示出可用的更新。图形界面很容易操作。您可以查看每个包的更新描述，改版记录（这是开发者们对所修改包的变化进行说明），最后您还可查看 Linux Mint 发出的警告或者关于更新的额外信息。你也可以查看当前电脑里包的版本,以及能够更新到的新版本。每个包的更新都会对包有所改进,或者解决了一些安全隐患,但并不意味着没有危险或者不会引进一些新的 bug。Linux Mint 会标记每个包的稳定级别，更新时给你提示是否安全。

当然您可以单击某列进行排序,可以按照稳定性,状态,包的名字,或者版本来排序。你可以通过“选择所有”按钮选中所有的更新,或者“清除”按钮都不选择。 

1,2 级别的更新通常是没有危险的,你可以选择更新。3 级别的更新 “应该是安全的”，但是我们建议你在更新表里仔细查看。如果你曾经在 3 级别上的更新出现过问题,请告诉 Linux Mint 研究小组,以便他们采取措施,把这个包放在 4,5 级别里,好警告其他用户不要进行这些更新。

![preferences-update-manager](https://github.com/oppih/LinuxMint-13-User-Guide-zh/raw/master/images/preferences-update-manager.png)

如果你单击“首选项”按钮,你将会看到上边图片所示的窗口。更新管理器会默认显示 1,2,3 级别的更新,你可以让 4,5 级别也显示出来。这将会在表里显示更多的可更新选项。如果你愿意,你甚至可以选择设置 4,5 级别为安全(尽管不推荐)。这样更新管理器就会默认选中他们这些更新。

更新管理器只计算“安全”的更新。因此，当它提示你的系统已经是最新,意味着在你所定义的安全级别中已经没有其他更新。

更新管理器只在表里显示“可见的”更新。

例如,你使各个级别都可见了,但是只有 1,2 级别是“安全的”。你会在表中看见很多的更新，但是更新管理器会告诉你的系统是最新的了。

通过“自动刷新”标签你可以设置更新管理器检查更新的周期。

通过“更新方式”标签页你可以设置让更新管理器如何检查最新的更新。 

“启动延时”是指更新管理器开启之前检查网络链接的时间。计算机启动时，这个延迟时间给网络管理器一个机会建立网络链接。

你也可以通过更新管理器定义的域名来检查网络链接情况。更新管理器会在查找更新前尝试ping这个域名。

“包括需要安装或删除其他软件包的更新” 选项让您选择是否让更新管理器建立新的包依赖关系。例如,包 A 的 1 版本已经安装在系统里，现在包 A 的 2 版本可用，但是 2 版本对 B 包有依赖，而 B 包又不存在电脑上。那该怎么办呢?

如果您不选中复选框,版本 2 就不会出现在更新管理器的列表中了。

如果你选中这个复选框，它就会安装 B 包来作为依赖。

在选择安装新包时要注意依赖关系,有时候会把你已经安装的包给删除了。

在“忽略的软件包”标签页中,可以设置您不想接受更新的包,可以使用“?”和“*”等通配符。

”代理“ 标签页是让您设置代理服务器的。

最后一个标签页"图标"是让您设置更新管理器在系统托盘里的图标的。

如果你在使用更新管理器时有错误发生（比如，不能刷新包列表），你可以检查日志文件。鼠标右击系统托盘，然后选择“信息”。显示如下： 

![information-update-manager](https://github.com/oppih/LinuxMint-13-User-Guide-zh/raw/master/images/information-update-manager.png)

![history-of-updates](https://github.com/oppih/LinuxMint-13-User-Guide-zh/raw/master/images/history-of-updates.png)

在上图中你可以看到更新管理器的进程ID号，是否以root权限运行，以及日志文件的内容。

你还可以查看你系统已经应用的更新情况(通过更新管理器提供的),通过单击“查看->更新的历史记录”来查看。
